extends layout
include utils.pug
append head
  //- add page specific styles by appending to the head
  link(rel="stylesheet" href="/stylesheets/index.css")
  //- add page specific js
  script(src="/javascripts/index.js" type="module" defer)

block content
  div(id='welcome_container')
    if locals.authenticated
      p Welcome #{locals.user.user_name}!
      form(method="post" action="/questions")
        input(type="hidden" name="_csrf" value=token)
        input(name="title" type="text" placeholder="What is your question?" required)
        button(id="welcome-submit-btn" type="submit") Submit
  h1= title
  div(class='questions-container')
    if questions && questions.length > 0
      each question in questions
        div(id=`question-container-${question.id}` class='question-container')
          input(type='hidden' id= `questionid` value= question.id)
          //- input(type='hidden' id= 'userid' value= user.id)
          div(class='question-offset')
            div(class='user-text')= question.User.user_name
            div(class='question-text')
              a(href=`/questions/${question.id}`) #{question.title}
            div(class='question-buttons')
              div(class='vote-section')
                if locals.authenticated
                  button(class='upvote-question-button' id= `${question.id}`) Like
                  div(class='vote_holder')= question.Questions_votes.length
              div(class='answer-delete-section')
                div
                  button(class='answer' id=`${question.id}`)
                    <i class="far fa-comment answer"> Answer</i>
            div(class='answerContain' id=`${question.id}`)
              form(action=`/questions/${question.id}/answers` method='post')
                input(type='hidden' name='_csrf' value=csrfToken)
                +field('Answer:', 'content')
                div
                  button(type='submit') Submit
          div(class='answers-container')
            if question.Answers && question.Answers.length > 0
              each answer in question.Answers
                div(class='answer-container')
                  div(class='user-text')= answer.User.user_name
                  div(class='answer-text')= answer.content
                  div(class='answer-buttons')
                    div(class='vote-section')
                      if locals.authenticated
                        button(class='upvote-answer-button' id=`UQ/${answer.id}`) Like
                        div(id=`answer-vote-holder-UQ/${answer.id}`)= answer.Answers_votes.length
